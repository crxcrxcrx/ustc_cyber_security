# 现代密码学基本理论

攻击类型：

- 唯密文攻击
  COA，Ciphtext-only
- 已知明文攻击
  KPA，Known-plaintext
  用同一密钥加密的一个或多个明文\-密文对
- 选择明文攻击
  CPA，Chosen-plaintext
  可选择特定明文，并获得对应的密文
- 选择密文攻击
  CCA，Chosen-ciphertext
  可选择特定密文，并获得对应的明文
- 选择文本攻击
  CCA，Chosen-text
  可选择特定密文/明文，并获得对应明文/密文
- 相关密钥攻击
  Related-key
  有确定关系的两个密钥对应的明文-密文对

攻击模型：

- 黑盒模型：攻击者并未实质性地接触到密钥或任何内部操作，仅能观察到一些外部信息或操作
- 灰盒模型：攻击者可以实质性地接触到部分密钥或泄露的信息
  - 边信道攻击（侧信道攻击），依赖于密码实现产生的信息源，使得攻击者可以观察或测量到密码实施时的某些特征
  - 对软件实现，可以是执行时间、返回值、错误消息等
  - 对硬件实现，可以是电磁辐射、功率、噪声等
  - 侵入式攻击，成本高昂，攻击者可以向软件或硬件中注入干扰信息、或修改，观察运行的变化。
- 白盒模型：攻击者清楚密码实现的所有细节，有能力实施侵入式攻击，可以随意修改。

安全目标：

单向性：攻击者不能计算出任何密文所对应的明文
不可区分性：攻击者无法区分密文 $C_i$ 来源于明文 $m_1$ 还是明文 $m_2$，或攻击者无法区分密文与随机序列
不可延展性：攻击者不能通过密文C（明文 m ）构造出一个密文 $C'$（明文 $m'$），使得 $m'$ 和 m 存在某种有意义的关系。

闭合系统：任意密文用任意密钥都可以获得一个明文。对确定性密码体制，密文数量和明文相等。

单纯密码：C1->M1->C2->M2 则必存在 C1->M2，其中每个箭头都是加密和解密过程。单纯密码可以根据连通性划分剩余类。每个剩余类都是闭合的。消息数量是密钥数的因子。单纯系统中，消息、密钥的后验概率与所属剩余类有关，与具体密文无关。

相似密码系统：若存在一个可逆映射A，使得密码系统R与S满足R=AS，则称R与S在密码分析意义上是相似的。在加密的开始或结束进行与密钥无关的运算，得到的是相似密码。

- 用数学上的难题做保证：可证明安全
- 用计算上的难题做保证：计算安全

信息论部分内容：

- 联合熵不小于其中一个的独立熵
- 条件熵不大于无条件熵
- 联合熵不大于独立熵的和
- 冗余度： $D=1-\frac{H(m)}{N}$，分子为信息量，分母为信息长度。压缩的意义：减少冗余

完美安全： 完美安全的充分必要条件为对所有的消息m和密文c，都有 $p_c(m)=p(m)$ 或 $p_m(c)=p(c)$

模糊度：获得一定密文后，消息或密钥的不确定度。定理：乘积密码S=TR中，消息的模糊度不低于仅使用R时的模糊度。总结：多一重加密没坏处。

若 $H(M)=H(C)$，则 $H_c(k)=H(k)$ 即密钥的模糊度与密文无关。

唯一解距离：存在唯一合理的密码分析所需要的密文数量， $N=H(K)/D$

定义：随机变量X的最小熵是对X的任一次实验，至少能获得的信息量。设一个好的密码系统，必须将破译工作量最大化，最小熵最大化。

密码攻击方式：

- 穷举攻击
- 如果可行的话，分组攻击（如分金币问题）
- 统计攻击
- 可能词攻击：消息中可能存在的词语如 the 等。

统计攻击：防御、扩散，如一对多。该方式不改变冗余度（只有压缩才能去除冗余）

总结：设计密码算法应使用的几个技术：

- 使用尽量多的密钥字来加密明文的每一部分
- 使用扩散和/或混淆技术增加统计分析的难度
- 每个密文字符由尽可能多的密钥字符和若干不相关的明文字符决定
- 建议交替使用代换和置乱算法，且在之间插入一个变换
