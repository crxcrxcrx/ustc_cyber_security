# 第4章 分组密码和数据加密标准

## 二进制代换密码

二进制到二进制的代换，不可用于较多的分组，64位分组的密钥大小 $2^{70}$ 位。

## Feistel 密码

舍弃绝对理想追求，两种对付统计分析的方法：

扩散：把明文统计特征消散在密文中，比如 $y_n=(\Sigma_{i=1}^km_{n+i})\text{mod}\ 26$

混淆：使密钥和密文的统计关系变得复杂。

Feistel 结构的典型特征：

- 分组长度：64，高级的128
- 密钥长度：128
- 迭代轮数：选择16

加密算法：

- $LE_i=RE_{i-1}$
- $RE_i=LE_{i-1}\oplus F(RE_{i-1},k_i)$

对轮函数的要求：

- 从可解密角度：任意函数，甚至可以为0
- 从安全角度：尽可能复杂

### DES 加密

DES 的明文长度是 64 位，密钥长度是 56 位。实际上把密钥扩充到 64 位。

DES 加密的方式使得差分攻击比穷举攻击更难。

轮函数：32->扩展置换->48->密钥异或->48->S盒置换->32->置换P->32

DES 安全性：

- 弱密钥（两次加密得到原文）和半弱密钥（两次分别用两个加密得到原文）
- 可以使用能量（功率）攻击。
- 统计攻击：差分攻击、线性攻击

差分攻击：

- 是一种选择明文攻击
- 分析明文对的差异和密文对的差异之间的关系
- 确定轮运算的子密钥，从而恢复某些密钥比特

线性攻击：攻击 16 轮 DES 需 $2^{43}$ 个已知明文

### 其他 Feistel 密码

- 双重 DES（一般不能简化为单重 DES）
  - 中间相遇攻击：X=E[K1, P]=D[K2, C]
  - 得到错误密钥的概率是 $1-2^{-16}$
- 三重 DES
  - C=E(K1,D(K2,E(K1,P)))
  - 没有可行的攻击办法
- Blowfish密码
  - Blowfish的S盒依赖于密钥，子密钥和S盒通过重复使用Blowfish本身产生，使得各比特彻底纠缠在一起，密码分析非常困难
  - 在每一循环中对数据的两部分进行操作，增大了密码强度
  - 通过选择适当的密钥长度(最长448位)，对穷举攻击来说，Blowfish几乎是不可破的
  - Blowfish的算法执行是很快的
- RC5 密码、SMS4 密码等
