5 数据库的保护

5.1 数据库的安全性
    保护方法
        用户标识与鉴别
            DBA为用户建立用户名和密码
            存在二次登录问题
        存取权限控制
            两要素
                数据对象
                操作类型
            授权
                定义某用户对哪些数据对象有哪些类型的操作
            数据对象粒度
                表, 列, 行
            权限控制种类
                控制用户
                控制操作类型
                控制数据对象
        使用视图
            建立视图屏蔽用户不该看到的内容
            但是安保功能不够精细
        数据加密
            对存储过程加密
        审计
            记录日志, 分为用户级和系统级

5.2 数据库的完整性
    实现机制
        数据库完整性约束条件
            作用对象粒度    
                列级
                    取值类型, 范围, 精度排序
                元组级
                    各字段间的联系
                关系级
                    多个记录或关系的联系
            其状态
                静态
                    数据库状态是合理的
                    实体完整性约束
                    参照完整性约束
                    函数依赖约束
                    统计约束
                动态
                    数据库的内容改变是合理的
                    列级约束
                    元组级约束
                    关系级约束
        完整性检查
            控制机制的功能
                定义功能
                    定义约束条件
                检查功能
                    检查是否符合完整性约束条件
                执行动作
                    能采取动作保证数据完整性
            检查功能
                立即执行约束
                延迟执行约束
    定义实体完整性语法
        constraint <规则名> 
            primary key ( <属性名> )
    定义参照完整性语法
        constraint <规则名>
            foreign key ( <属性名> )
            references <表名>(属性名)
    定义用户自定义完整性语法
        constraint <规则名>
            check <条件>

5.3 数据库的并发控制
    事务
        并发控制的单位
        原子性
            操作不可分割
            DBMS事务管理子系统实现
        一致性
            保证数据库正常一致
            程序员和系统完整性约束检查实现
        隔离性
            多事务并发, 应保证互相不干扰
            DBMS并发控制子系统实现
        持久性
            事务完成提交则更新永久反映在数据库中不丢失
            数据库恢复管理子系统实现
    四大问题
        修改丢失问题
            写后写
        脏读问题
            写后读回退
        不可重复读问题
            执行代码写后读不一致
        幻影读
            执行操作写后读不一致
    数据库封锁机制
        排他锁X
            修改时加
        共享锁S
            查询时加
        修改锁U
            将要修改时加
            并非所有DBMS都有
        XSU横纵, Y右上左下右下全占
    两种需要处理的危险
        活锁
            一个事务永远等待
            需要先申请先服务解决
        死锁
            两个事务占用互相需要的资源互相等待
            一次封锁法, 一次性全加锁
            顺序封锁法, 尽量按同一次序访问资源

5.4 数据库的恢复
    故障种类
        事务故障
            前端代码执行故障
            须回滚未完成事务的部分修改, 事务撤销
        系统故障
            DBMS, OS, 硬件出错导致导致事务异常终止
            须回滚未完成事务的部分修改, 事务撤销
            须回滚已提交未写入的事务, 重做
        介质故障
            硬件故障
            须用副本替代然后重做所有成功事务

5.5 数据库的复制与镜像